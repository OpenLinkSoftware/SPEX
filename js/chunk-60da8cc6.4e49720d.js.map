{"version":3,"sources":["webpack:///./node_modules/@rdf-esm/formats-common/parsers.js","webpack:///./node_modules/@rdf-esm/formats-common/serializers.js","webpack:///./node_modules/@rdf-esm/formats-common/index.js","webpack:///./node_modules/@rdf-esm/sink-map/index.js","webpack:///./src/views/RdfEditor.vue?1fa8","webpack:///src/views/RdfEditor.vue","webpack:///./src/views/RdfEditor.vue?c314","webpack:///./src/views/RdfEditor.vue"],"names":["async","jsonLdParser","JsonLdParser","default","n3Parser","N3Parser","rdfXmlParser","module","RdfXmlParser","jsonLdSerializer","JsonLdSerializer","encoding","nTriplesSerializer","NTriplesSerializer","parserMap","serializerMap","set","parsers","serializers","SinkMap","Map","key","input","options","sink","this","get","passThrough","PassThrough","objectMode","Promise","resolve","then","sinkInstance","origStream","import","on","err","emit","pipe","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_v","model","value","callback","$$v","format","expression","_l","domProps","_s","ref","shacl","onParsingFailed","onQuadsChanged","parseError","_e","resources","links","activeLinks","onLinkHover","onUnhover","scopedSlots","_u","fn","node","onHoverResource","onHoverProperty","endpoint","staticRenderFns","components","GraphLayout","Splitpanes","Pane","ResourceCard","Term","data","formats","initialEditorContent","shrink","computed","methods","push","link","filter","e","loadResources","extractResources","acc","has","predicate","id","term","name","values","property","add","object","subject","properties","component"],"mappings":"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","file":"js/chunk-60da8cc6.4e49720d.js","sourcesContent":["export async function jsonLdParser () {\n  const JsonLdParser = (await import('@rdfjs/parser-jsonld')).default\n\n  return new JsonLdParser()\n}\n\nexport async function n3Parser () {\n  const N3Parser = (await import('@rdfjs/parser-n3')).default\n  return new N3Parser()\n}\n\nexport async function rdfXmlParser () {\n  const module = await import('rdfxml-streaming-parser')\n\n  let RdfXmlParser\n  if (module.default) {\n    RdfXmlParser = module.default.RdfXmlParser\n  } else {\n    RdfXmlParser = module.RdfXmlParser\n  }\n\n  return new RdfXmlParser()\n}\n","export async function jsonLdSerializer () {\n  const JsonLdSerializer = (await import('@rdfjs/serializer-jsonld')).default\n\n  return new JsonLdSerializer({ encoding: 'string' })\n}\n\nexport async function nTriplesSerializer () {\n  const NTriplesSerializer = (await import('@rdfjs/serializer-ntriples')).default\n\n  return new NTriplesSerializer()\n}\n","import {\n  jsonLdParser,\n  n3Parser,\n  rdfXmlParser\n} from './parsers.js'\nimport {\n  jsonLdSerializer,\n  nTriplesSerializer\n} from './serializers.js'\nimport { SinkMap } from '@rdf-esm/sink-map'\n\nconst parserMap = new SinkMap()\nconst serializerMap = new SinkMap()\n\nparserMap.set('application/ld+json', jsonLdParser)\nparserMap.set('application/trig', n3Parser)\nparserMap.set('application/n-quads', n3Parser)\nparserMap.set('application/n-triples', n3Parser)\nparserMap.set('text/n3', n3Parser)\nparserMap.set('text/turtle', n3Parser)\nparserMap.set('application/rdf+xml', rdfXmlParser)\n\nserializerMap.set('application/ld+json', jsonLdSerializer)\nserializerMap.set('application/n-quads', nTriplesSerializer)\nserializerMap.set('application/n-triples', nTriplesSerializer)\nserializerMap.set('text/n3', nTriplesSerializer)\nserializerMap.set('text/turtle', nTriplesSerializer)\n\nexport const parsers = parserMap\nexport const serializers = serializerMap\n","import stream from 'readable-stream'\n\nclass SinkMap extends Map {\n  import (key, input, options) {\n    const sink = this.get(key)\n\n    if (!sink) {\n      return null\n    }\n\n    if (typeof sink === 'function') {\n      const passThrough = new stream.PassThrough({ objectMode: true })\n      Promise.resolve().then(async () => {\n        const sinkInstance = await sink()\n        this.set(key, sinkInstance)\n\n        const origStream = sinkInstance.import(input, options)\n        origStream.on('error', err => {\n          passThrough.emit('error', err)\n          passThrough.emit('end')\n        })\n\n        origStream.pipe(passThrough)\n      })\n\n      return passThrough\n    }\n\n    return sink.import(input, options)\n  }\n}\n\nexport { SinkMap }\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Splitpanes',{staticClass:\"default-theme\"},[_c('Pane',{attrs:{\"size\":\"40\"}},[_c('header',{staticClass:\"px-4 py-2 bg-gray-200 flex items-center justify-between\"},[_c('h2',{staticClass:\"font-bold text-lg\"},[_vm._v(\"RDF editor\")]),_c('b-select',{model:{value:(_vm.format),callback:function ($$v) {_vm.format=$$v},expression:\"format\"}},_vm._l((_vm.formats),function(format){return _c('option',{key:format,domProps:{\"value\":format}},[_vm._v(_vm._s(format))])}),0)],1),_c('rdf-editor',{ref:\"shaclEditor\",staticClass:\"w-full h-full overflow-hidden\",attrs:{\"format\":_vm.format,\"value\":_vm.shacl,\"auto-parse\":\"\",\"parseDelay\":\"1000\"},on:{\"parsing-failed\":_vm.onParsingFailed,\"quads-changed\":_vm.onQuadsChanged}}),(_vm.parseError)?_c('div',{staticClass:\"message is-danger mb-0\"},[_c('div',{staticClass:\"message-body\"},[_vm._v(\" \"+_vm._s(_vm.parseError)+\" \")])]):_vm._e()],1),_c('Pane',[_c('Splitpanes',{attrs:{\"horizontal\":\"\"}},[_c('Pane',[_c('div',{staticClass:\"flex-grow flex flex-col\"},[_c('header',{staticClass:\"px-4 py-2 bg-gray-200 flex items-center justify-between\"},[_c('h2',{staticClass:\"font-bold text-lg\"},[_vm._v(\"Representation\")]),_c('b-input',{staticClass:\"invisible\",attrs:{\"readonly\":\"\"}})],1),_c('GraphLayout',{staticClass:\"card-content p-0\",attrs:{\"nodes\":_vm.resources,\"links\":_vm.links,\"active-links\":_vm.activeLinks,\"auto-zoom\":false},on:{\"link-enter\":_vm.onLinkHover,\"link-out\":_vm.onUnhover},scopedSlots:_vm._u([{key:\"node\",fn:function(ref){\nvar node = ref.node;\nreturn [_c('ResourceCard',{attrs:{\"resource\":node,\"active-links\":_vm.activeLinks},on:{\"hover-title\":_vm.onHoverResource,\"unhover-title\":_vm.onUnhover,\"hover-property\":_vm.onHoverProperty,\"unhover-property\":_vm.onUnhover},scopedSlots:_vm._u([{key:\"property-value\",fn:function(ref){\nvar value = ref.value;\nreturn [_c('div',{staticClass:\"flex items-center\"},[_c('Term',{attrs:{\"term\":value,\"endpoint\":_vm.endpoint}})],1)]}}],null,true)})]}}])})],1)])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Splitpanes class=\"default-theme\">\n    <Pane size=\"40\">\n      <header class=\"px-4 py-2 bg-gray-200 flex items-center justify-between\">\n        <h2 class=\"font-bold text-lg\">RDF editor</h2>\n        <b-select v-model=\"format\">\n          <option v-for=\"format in formats\" :key=\"format\" :value=\"format\">{{ format }}</option>\n        </b-select>\n      </header>\n      <rdf-editor\n        class=\"w-full h-full overflow-hidden\"\n        :format=\"format\"\n        :value=\"shacl\"\n        ref=\"shaclEditor\"\n        auto-parse\n        parseDelay=\"1000\"\n        @parsing-failed=\"onParsingFailed\"\n        @quads-changed=\"onQuadsChanged\"\n      />\n      <div v-if=\"parseError\" class=\"message is-danger mb-0\">\n        <div class=\"message-body\">\n          {{ parseError }}\n        </div>\n      </div>\n    </Pane>\n    <Pane>\n      <Splitpanes horizontal>\n        <Pane>\n          <div class=\"flex-grow flex flex-col\">\n            <header class=\"px-4 py-2 bg-gray-200 flex items-center justify-between\">\n              <h2 class=\"font-bold text-lg\">Representation</h2>\n              <!-- Hack to fix header height :shrug: -->\n              <b-input class=\"invisible\" readonly />\n            </header>\n\n            <GraphLayout\n              class=\"card-content p-0\"\n              :nodes=\"resources\"\n              :links=\"links\"\n              :active-links=\"activeLinks\"\n              :auto-zoom=\"false\"\n              @link-enter=\"onLinkHover\"\n              @link-out=\"onUnhover\"\n            >\n              <template v-slot:node=\"{ node }\">\n                <ResourceCard\n                  :resource=\"node\"\n                  :active-links=\"activeLinks\"\n                  @hover-title=\"onHoverResource\"\n                  @unhover-title=\"onUnhover\"\n                  @hover-property=\"onHoverProperty\"\n                  @unhover-property=\"onUnhover\"\n                >\n                  <template v-slot:property-value=\"{ value }\">\n                    <div class=\"flex items-center\">\n                      <Term :term=\"value\" :endpoint=\"endpoint\" />\n                    </div>\n                  </template>\n                </ResourceCard>\n              </template>\n            </GraphLayout>\n          </div>\n        </Pane>\n      </Splitpanes>\n    </Pane>\n  </Splitpanes>\n</template>\n\n<script>\nimport RDF from '@rdfjs/dataset'\nimport { shrink } from '@zazuko/rdf-vocabularies/shrink'\nimport { Splitpanes, Pane } from 'splitpanes'\nimport 'splitpanes/dist/splitpanes.css'\nimport '@rdfjs-elements/rdf-editor'\nimport TermSet from '@rdfjs/term-set'\nimport { parsers } from '@rdf-esm/formats-common'\nimport GraphLayout from '@/components/GraphLayout.vue'\nimport ResourceCard from '@/components/ResourceCard.vue'\nimport Term from '@/components/Term.vue'\n\nconst formats = [...parsers.keys()]\n\nconst initialEditorContent = ''\n\nexport default {\n  components: {\n    GraphLayout,\n    Splitpanes,\n    Pane,\n    ResourceCard,\n    Term,\n  },\n\n  data () {\n    return {\n      format: 'text/turtle',\n      formats,\n      shacl: initialEditorContent,\n      resources: [],\n      parseError: null,\n      activeLinks: [],\n      endpoint: {\n        shrink (uri) {\n          return shrink(uri) || uri\n        },\n      },\n    }\n  },\n\n  computed: {\n    links () {\n      const resources = this.resources\n      const resourceIds = new TermSet(resources.map(({ term }) => term))\n\n      return resources\n        .flatMap(resource => resource.properties.map((property) => ({ ...property, resource })))\n        .reduce((links, property) => {\n          property.values.forEach((value) => {\n            const source = property.resource.term\n            const target = value\n\n            if (resourceIds.has(target)) {\n              links.push({\n                source: source.value,\n                target: target.value,\n                sourceProperty: property.id,\n                label: property.name,\n              })\n            }\n          })\n\n          return links\n        }, [])\n    },\n  },\n\n  methods: {\n    onLinkHover (link) {\n      this.activeLinks.push(link)\n    },\n\n    onUnhover () {\n      this.activeLinks = []\n    },\n\n    onHoverResource (resource) {\n      this.activeLinks = this.links.filter((link) => link.source === resource.id)\n    },\n\n    onHoverProperty (resource, property) {\n      this.activeLinks = this.links.filter((link) => (\n        link.source === resource.id &&\n        link.sourceProperty === property.id\n      ))\n    },\n\n    onParsingFailed (e) {\n      this.parseError = e?.detail?.error\n    },\n\n    onQuadsChanged (e) {\n      this.parseError = null\n      this.loadResources()\n    },\n\n    async loadResources () {\n      const editor = this.$refs.shaclEditor\n\n      this.resources = []\n\n      const quads = await editor.quads\n      const dataset = RDF.dataset(quads)\n      this.resources = extractResources(dataset, this.endpoint)\n    },\n\n  }\n}\n\nfunction extractResources (dataset, endpoint) {\n  const subjects = new TermSet([...dataset].map(({ subject }) => subject))\n\n  return [...subjects].map(subject => {\n    const quads = dataset.match(subject)\n    const properties = [...quads].reduce((acc, { predicate, object }) => {\n      if (!acc.has(predicate.value)) {\n        const property = {\n          id: predicate.value,\n          term: predicate,\n          name: endpoint.shrink(predicate.value),\n          values: new TermSet(),\n        }\n        acc.set(predicate.value, property)\n      }\n\n      acc.get(predicate.value).values.add(object)\n\n      return acc\n    }, new Map())\n\n    return {\n      id: subject.value,\n      term: subject,\n      name: endpoint.shrink(subject.value),\n      properties: [...properties.values()],\n    }\n  })\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RdfEditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RdfEditor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RdfEditor.vue?vue&type=template&id=23b3d8c0&\"\nimport script from \"./RdfEditor.vue?vue&type=script&lang=js&\"\nexport * from \"./RdfEditor.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}