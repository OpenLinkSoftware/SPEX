{"version":3,"sources":["webpack:///./src/views/ShaclEditor.vue?8d20","webpack:///src/views/ShaclEditor.vue","webpack:///./src/views/ShaclEditor.vue?c975","webpack:///./src/views/ShaclEditor.vue","webpack:///./node_modules/@rdf-esm/formats-common/parsers.js","webpack:///./node_modules/@rdf-esm/formats-common/serializers.js","webpack:///./node_modules/@rdf-esm/formats-common/index.js","webpack:///./node_modules/@rdf-esm/sink-map/index.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","ref","format","shacl","model","value","callback","$$v","expression","_l","key","domProps","_s","on","loadShacl","datamodel","tables","links","activeLinks","scopedSlots","_u","fn","node","error","_e","staticRenderFns","components","GraphLayout","Splitpanes","Pane","ResourceCard","data","formats","initialEditorContent","viewports","isIntrospected","computed","methods","component","async","jsonLdParser","JsonLdParser","default","n3Parser","N3Parser","rdfXmlParser","module","RdfXmlParser","jsonLdSerializer","JsonLdSerializer","encoding","nTriplesSerializer","NTriplesSerializer","parserMap","serializerMap","set","parsers","serializers","SinkMap","Map","input","options","sink","get","passThrough","PassThrough","objectMode","Promise","resolve","then","sinkInstance","origStream","import","err","emit","pipe"],"mappings":"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","file":"js/chunk-61091506.00621f14.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Splitpanes',{staticClass:\"default-theme\"},[_c('Pane',{attrs:{\"size\":\"40\"}},[_c('h2',{staticClass:\"font-bold text-lg px-4 py-2 bg-gray-200\"},[_vm._v(\"SHACL editor\")]),_c('rdf-editor',{ref:\"shaclEditor\",staticClass:\"w-full h-full overflow-hidden\",attrs:{\"format\":_vm.format,\"value\":_vm.shacl}}),_c('b-field',{attrs:{\"label\":\"Format\"}},[_c('b-select',{model:{value:(_vm.format),callback:function ($$v) {_vm.format=$$v},expression:\"format\"}},_vm._l((_vm.formats),function(format){return _c('option',{key:format,domProps:{\"value\":format}},[_vm._v(_vm._s(format))])}),0)],1),_c('b-button',{attrs:{\"type\":\"is-primary\",\"icon-left\":\"sync\"},on:{\"click\":_vm.loadShacl}},[_vm._v(\"Update\")])],1),_c('Pane',[_c('Splitpanes',{attrs:{\"horizontal\":\"\"}},[_c('Pane',[_c('div',{staticClass:\"flex-grow flex flex-col\"},[_c('h2',{staticClass:\"font-bold text-lg px-4 py-2 bg-gray-200\"},[_vm._v(\"Representation\")]),_c('GraphLayout',{attrs:{\"nodes\":_vm.datamodel.tables,\"links\":_vm.links,\"active-links\":_vm.activeLinks},scopedSlots:_vm._u([{key:\"node\",fn:function(ref){\nvar node = ref.node;\nreturn [_c('ResourceCard',{attrs:{\"resource\":node,\"active-links\":_vm.activeLinks}})]}}])}),(_vm.error)?_c('div',{staticClass:\"section\"},[_c('div',{staticClass:\"message is-danger\"},[_c('div',{staticClass:\"message-body\"},[_vm._v(\" Error loading data: \"+_vm._s(_vm.error)+\" \")])])]):_vm._e()],1)])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Splitpanes class=\"default-theme\">\n    <Pane size=\"40\">\n      <h2 class=\"font-bold text-lg px-4 py-2 bg-gray-200\">SHACL editor</h2>\n      <rdf-editor class=\"w-full h-full overflow-hidden\" :format=\"format\" :value=\"shacl\" ref=\"shaclEditor\" />\n      <b-field label=\"Format\">\n        <b-select v-model=\"format\">\n          <option v-for=\"format in formats\" :key=\"format\" :value=\"format\">{{ format }}</option>\n        </b-select>\n      </b-field>\n      <b-button type=\"is-primary\" icon-left=\"sync\" @click=\"loadShacl\">Update</b-button>\n    </Pane>\n    <Pane>\n      <Splitpanes horizontal>\n        <Pane>\n          <div class=\"flex-grow flex flex-col\">\n            <h2 class=\"font-bold text-lg px-4 py-2 bg-gray-200\">Representation</h2>\n\n            <GraphLayout\n              :nodes=\"datamodel.tables\"\n              :links=\"links\"\n              :active-links=\"activeLinks\"\n            >\n              <template v-slot:node=\"{ node }\">\n                <ResourceCard :resource=\"node\" :active-links=\"activeLinks\" />\n              </template>\n            </GraphLayout>\n\n            <div class=\"section\" v-if=\"error\">\n              <div class=\"message is-danger\">\n                <div class=\"message-body\">\n                  Error loading data: {{ error }}\n                </div>\n              </div>\n            </div>\n          </div>\n        </Pane>\n      </Splitpanes>\n    </Pane>\n  </Splitpanes>\n</template>\n\n<script>\nimport RDF from '@rdfjs/dataset'\nimport { shrink } from '@zazuko/rdf-vocabularies/shrink'\nimport { Splitpanes, Pane } from 'splitpanes'\nimport 'splitpanes/dist/splitpanes.css'\nimport '@rdfjs-elements/rdf-editor'\nimport { parsers } from '@rdf-esm/formats-common'\nimport clownface from 'clownface'\nimport { tablesFromSHACL } from '@/shacl'\nimport { rdf, sh } from '@/namespace'\nimport GraphLayout from '@/components/GraphLayout.vue'\nimport ResourceCard from '@/components/ResourceCard.vue'\n\nconst formats = [...parsers.keys()]\n\nconst initialEditorContent = `\n@prefix sh: <http://www.w3.org/ns/shacl#> .\n@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .\n`\n\nexport default {\n  components: {\n    GraphLayout,\n    Splitpanes,\n    Pane,\n    ResourceCard,\n  },\n\n  data () {\n    return {\n      format: 'text/turtle',\n      formats,\n      shacl: initialEditorContent,\n      datamodel: {\n        tables: [],\n        viewports: [],\n        isIntrospected: false,\n      },\n      error: null,\n      activeLinks: [],\n    }\n  },\n\n  computed: {\n    links () {\n      const tables = this.datamodel.tables\n      const tableIds = new Set(tables.map(({ id }) => id))\n      return tables\n        .flatMap(table => table.properties.map((property) => ({ ...property, table })))\n        .reduce((acc, property) => {\n          property.values.forEach((value) => {\n            const source = property.table.id\n            const target = value.id\n            if (tableIds.has(target)) {\n              acc.push({ source, target, sourceProperty: property.id, label: property.name })\n            }\n          })\n\n          return acc\n        }, [])\n    },\n  },\n\n  methods: {\n    async loadShacl () {\n      const editor = this.$refs.shaclEditor\n\n      this.error = null\n      this.datamodel.tables = []\n\n      const endpoint = {\n        shrink (uri) {\n          return shrink(uri) || uri\n        }\n      }\n\n      try {\n        const quads = await editor.quads\n        const dataset = RDF.dataset(quads)\n        const shapes = clownface({ dataset }).has(rdf.type, sh.NodeShape)\n        this.datamodel.tables = tablesFromSHACL(shapes, endpoint)\n      } catch (e) {\n        this.error = e.toString()\n      }\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShaclEditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ShaclEditor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ShaclEditor.vue?vue&type=template&id=da81a1d8&\"\nimport script from \"./ShaclEditor.vue?vue&type=script&lang=js&\"\nexport * from \"./ShaclEditor.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export async function jsonLdParser () {\n  const JsonLdParser = (await import('@rdfjs/parser-jsonld')).default\n\n  return new JsonLdParser()\n}\n\nexport async function n3Parser () {\n  const N3Parser = (await import('@rdfjs/parser-n3')).default\n  return new N3Parser()\n}\n\nexport async function rdfXmlParser () {\n  const module = await import('rdfxml-streaming-parser')\n\n  let RdfXmlParser\n  if (module.default) {\n    RdfXmlParser = module.default.RdfXmlParser\n  } else {\n    RdfXmlParser = module.RdfXmlParser\n  }\n\n  return new RdfXmlParser()\n}\n","export async function jsonLdSerializer () {\n  const JsonLdSerializer = (await import('@rdfjs/serializer-jsonld')).default\n\n  return new JsonLdSerializer({ encoding: 'string' })\n}\n\nexport async function nTriplesSerializer () {\n  const NTriplesSerializer = (await import('@rdfjs/serializer-ntriples')).default\n\n  return new NTriplesSerializer()\n}\n","import {\n  jsonLdParser,\n  n3Parser,\n  rdfXmlParser\n} from './parsers.js'\nimport {\n  jsonLdSerializer,\n  nTriplesSerializer\n} from './serializers.js'\nimport { SinkMap } from '@rdf-esm/sink-map'\n\nconst parserMap = new SinkMap()\nconst serializerMap = new SinkMap()\n\nparserMap.set('application/ld+json', jsonLdParser)\nparserMap.set('application/trig', n3Parser)\nparserMap.set('application/n-quads', n3Parser)\nparserMap.set('application/n-triples', n3Parser)\nparserMap.set('text/n3', n3Parser)\nparserMap.set('text/turtle', n3Parser)\nparserMap.set('application/rdf+xml', rdfXmlParser)\n\nserializerMap.set('application/ld+json', jsonLdSerializer)\nserializerMap.set('application/n-quads', nTriplesSerializer)\nserializerMap.set('application/n-triples', nTriplesSerializer)\nserializerMap.set('text/n3', nTriplesSerializer)\nserializerMap.set('text/turtle', nTriplesSerializer)\n\nexport const parsers = parserMap\nexport const serializers = serializerMap\n","import stream from 'readable-stream'\n\nclass SinkMap extends Map {\n  import (key, input, options) {\n    const sink = this.get(key)\n\n    if (!sink) {\n      return null\n    }\n\n    if (typeof sink === 'function') {\n      const passThrough = new stream.PassThrough({ objectMode: true })\n      Promise.resolve().then(async () => {\n        const sinkInstance = await sink()\n        this.set(key, sinkInstance)\n\n        const origStream = sinkInstance.import(input, options)\n        origStream.on('error', err => {\n          passThrough.emit('error', err)\n          passThrough.emit('end')\n        })\n\n        origStream.pipe(passThrough)\n      })\n\n      return passThrough\n    }\n\n    return sink.import(input, options)\n  }\n}\n\nexport { SinkMap }\n"],"sourceRoot":""}